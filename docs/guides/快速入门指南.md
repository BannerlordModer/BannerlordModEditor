# Bannerlord Mod Editor - 快速入门指南

## 概述

本指南将帮助您快速上手使用Bannerlord Mod Editor工具进行骑马与砍杀2模组开发。无论您是使用图形界面、命令行工具还是终端界面，本指南都将为您提供清晰的步骤指引。

## 🎯 适合人群

- **模组开发者**：需要编辑XML配置文件的模组作者
- **内容创作者**：需要批量处理游戏配置的内容创作者
- **技术爱好者**：对游戏配置文件处理感兴趣的技术人员
- **新手开发者**：想要学习XML处理的初学者

## 🚀 快速开始

### 第一步：环境准备

#### 系统要求
- **.NET 9.0 SDK**（必需）
- **内存**：推荐8GB以上
- **系统**：Windows、macOS、Linux均可

#### 安装.NET 9.0
```bash
# Ubuntu/Debian
wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
sudo apt-get update
sudo apt-get install -y dotnet-sdk-9.0

# macOS (使用Homebrew)
brew install dotnet

# Windows
# 下载并安装 .NET 9.0 SDK from https://dotnet.microsoft.com/download
```

### 第二步：获取项目

```bash
# 克隆项目
git clone <repository-url>
cd BannerlordModEditor-CLI

# 还原依赖
dotnet restore

# 构建项目
dotnet build
```

### 第三步：运行测试（推荐）

```bash
# 运行所有测试确保环境正常
dotnet test --verbosity normal
```

## 🛠️ 选择您的工具

Bannerlord Mod Editor提供三种界面选择：

### 1. 图形界面 (GUI) - 适合新手
```bash
# 启动图形界面
dotnet run --project BannerlordModEditor.UI
```

**特点**：
- 可视化操作，直观易用
- 拖拽文件处理
- 实时预览和编辑
- 适合不熟悉命令行的用户

### 2. 命令行工具 (CLI) - 适合开发者
```bash
# 查看帮助
dotnet run --project BannerlordModEditor.Cli -- --help

# 列出支持的模型
dotnet run --project BannerlordModEditor.Cli -- list-models
```

**特点**：
- 批量处理能力强
- 可集成到脚本中
- 详细的日志输出
- 适合自动化任务

### 3. 终端界面 (TUI) - 适合高级用户
```bash
# 启动终端界面
dotnet run --project BannerlordModEditor.TUI
```

**特点**：
- 键盘快捷键操作
- 资源占用低
- 远程服务器友好
- 适合熟悉终端的用户

## 📋 常用任务指南

### 任务1：将Excel转换为XML

#### 使用CLI
```bash
# 转换Excel到XML
dotnet run --project BannerlordModEditor.Cli -- convert -i "actions.xlsx" -o "actions.xml" -m "ActionTypesDO"
```

#### 使用GUI
1. 启动GUI应用程序
2. 点击"打开文件"选择Excel文件
3. 选择转换类型（Excel→XML）
4. 选择数据模型类型
5. 点击"转换"按钮

#### 使用TUI
1. 启动TUI应用程序
2. 按F2选择源文件（Excel）
3. 按F4选择目标文件（XML）
4. 按F1切换转换方向
5. 按F5执行转换

### 任务2：将XML转换为Excel

#### 使用CLI
```bash
# 转换XML到Excel
dotnet run --project BannerlordModEditor.Cli -- convert -i "actions.xml" -o "actions.xlsx"
```

#### 使用GUI
1. 启动GUI应用程序
2. 点击"打开文件"选择XML文件
3. 选择转换类型（XML→Excel）
4. 点击"转换"按钮

#### 使用TUI
1. 启动TUI应用程序
2. 按F2选择源文件（XML）
3. 按F4选择目标文件（Excel）
4. 按F1切换转换方向
5. 按F5执行转换

### 任务3：识别XML文件类型

#### 使用CLI
```bash
# 识别XML文件类型
dotnet run --project BannerlordModEditor.Cli -- recognize -i "unknown_file.xml"

# 批量识别目录中的XML文件
dotnet run --project BannerlordModEditor.Cli -- recognize --directory "ModuleData" --recursive
```

#### 使用GUI
1. 启动GUI应用程序
2. 点击"打开文件"选择XML文件
3. 查看自动识别的文件类型信息

### 任务4：验证Excel格式

#### 使用CLI
```bash
# 验证Excel格式
dotnet run --project BannerlordModEditor.Cli -- convert -i "actions.xlsx" -o "temp.xml" -m "ActionTypesDO" --validate
```

## 📊 支持的数据模型

### 核心游戏机制
| 模型名称 | 用途 | 文件示例 |
|----------|------|----------|
| ActionTypesDO | 动作类型配置 | action_types.xml |
| CombatParametersDO | 战斗参数 | combat_parameters.xml |
| ActionSetsDO | 动作集配置 | action_sets.xml |
| AttributesDO | 角色属性 | attributes.xml |
| SkillsDO | 技能配置 | skills.xml |

### 物品系统
| 模型名称 | 用途 | 文件示例 |
|----------|------|----------|
| ItemModifiersDO | 物品修饰符 | item_modifiers.xml |
| CraftingPiecesDO | 制作部件 | crafting_pieces.xml |
| ItemHolstersDO | 物品携带位置 | item_holsters.xml |

### 多人游戏
| 模型名称 | 用途 | 文件示例 |
|----------|------|----------|
| MpItemsDO | 多人物品 | mpitems.xml |
| MpCraftingPiecesDO | 多人制作部件 | mp_crafting_pieces.xml |
| MpCosmeticsDO | 多人装饰品 | mpcosmetics.xml |

### 查看完整列表
```bash
dotnet run --project BannerlordModEditor.Cli -- list-models --detailed
```

## 📁 文件格式要求

### Excel文件格式
```
name        | type        | usage_direction | action_stage
------------|-------------|-----------------|--------------
attack_1    | thrust      | forward         | ready
attack_2    | swing       | horizontal     | ready
defend_1    | block       | up              | ready
```

**要求**：
- 第一行必须为列标题
- 列名应与XML元素对应
- 支持文本、数字、日期等基本类型
- 建议使用UTF-8编码

### XML文件格式
```xml
<?xml version="1.0" encoding="utf-8"?>
<action_types>
  <action>
    <name>attack_1</name>
    <type>thrust</type>
    <usage_direction>forward</usage_direction>
    <action_stage>ready</action_stage>
  </action>
  <action>
    <name>attack_2</name>
    <type>swing</type>
    <usage_direction>horizontal</usage_direction>
    <action_stage>ready</action_stage>
  </action>
</action_types>
```

**要求**：
- 必须为有效的XML文档
- 使用UTF-8编码
- 根元素名称与数据模型对应

## 🎯 实际应用场景

### 场景1：模组开发
```bash
# 1. 将游戏XML导出为Excel便于编辑
dotnet run --project BannerlordModEditor.Cli -- convert -i "ModuleData/action_types.xml" -o "action_types_editable.xlsx"

# 2. 在Excel中编辑数据...

# 3. 将编辑后的Excel转换回XML
dotnet run --project BannerlordModEditor.Cli -- convert -i "action_types_editable.xlsx" -o "ModuleData/action_types_modified.xml" -m "ActionTypesDO"
```

### 场景2：批量处理
```bash
# 批量转换多个XML文件
for file in ModuleData/*.xml; do
    echo "处理 $file"
    dotnet run --project BannerlordModEditor.Cli -- convert -i "$file" -o "${file%.xml}.xlsx"
done
```

### 场景3：数据分析
```bash
# 1. 将XML转换为Excel进行分析
dotnet run --project BannerlordModEditor.Cli -- convert -i "items.xml" -o "items_analysis.xlsx"

# 2. 在Excel中使用数据透视表、图表等工具分析数据

# 3. 根据分析结果调整游戏平衡性
```

## 🔧 故障排除

### 常见问题

#### 1. .NET环境问题
```bash
# 检查.NET版本
dotnet --version

# 如果版本不是9.0，请安装正确的版本
```

#### 2. 文件路径问题
```bash
# 使用绝对路径避免路径问题
dotnet run --project BannerlordModEditor.Cli -- convert -i "/full/path/to/file.xlsx" -o "/full/path/to/output.xml" -m "ActionTypesDO"
```

#### 3. 模型类型错误
```bash
# 查看支持的模型类型
dotnet run --project BannerlordModEditor.Cli -- list-models

# 搜索特定模型
dotnet run --project BannerlordModEditor.Cli -- list-models --search "action"
```

#### 4. 内存不足
```bash
# 分批处理大文件
# 或者增加系统内存
```

### 获取帮助

#### 命令行帮助
```bash
# 主帮助
dotnet run --project BannerlordModEditor.Cli -- --help

# 特定命令帮助
dotnet run --project BannerlordModEditor.Cli -- convert --help
```

#### 详细日志
```bash
# 启用详细输出
dotnet run --project BannerlordModEditor.Cli -- convert -i "data.xlsx" -o "data.xml" -m "ActionTypesDO" --verbose
```

## 📚 进阶学习

### 完整文档
- [CLI用户指南](guides/CLI用户指南.md) - 详细的CLI使用说明
- [TUI用户指南](guides/TUI用户指南.md) - 终端界面使用指南
- [架构设计文档](reference/architecture.md) - 系统架构说明
- [技术规格文档](development/technical/) - 完整技术规格

### 开发指南
- [添加新的XML适配](development/technical/xml-adaptation-implementation-guide.md)
- [测试策略](guides/comprehensive-test-suite.md)
- [项目计划](development/project/) - 项目需求和计划

### 示例和模板
- `example/ModuleData/` - 真实的游戏XML文件示例
- `BannerlordModEditor.Common.Tests/TestData/` - 测试数据文件

## 🤝 社区和支持

### 获取帮助
- **GitHub Issues**：报告bug和功能请求
- **讨论区**：技术讨论和经验分享
- **文档**：详细的使用指南和技术文档

### 贡献代码
1. Fork项目仓库
2. 创建功能分支
3. 提交更改并测试
4. 创建Pull Request

## 📈 下一步

### 熟悉基础操作后，您可以：

1. **探索高级功能**：学习批量处理、脚本集成等高级用法
2. **自定义模型**：了解如何添加新的数据模型支持
3. **性能优化**：学习如何优化大文件处理性能
4. **贡献代码**：为项目贡献新功能和改进

### 推荐学习路径：
1. 基础文件转换（当前指南）
2. [CLI用户指南](guides/CLI用户指南.md) - 深入CLI功能
3. [TUI用户指南](guides/TUI用户指南.md) - 学习终端界面
4. [技术规格文档](development/technical/) - 了解技术实现
5. [项目计划](development/project/) - 参与项目开发

---

**祝您使用愉快！如有问题，请随时寻求帮助。**

**最后更新**: 2025年8月26日  
**项目状态**: 生产就绪  
**维护团队**: BannerlordModEditor开发团队